import{r as o,j as u,a as e,F as P}from"./index-15cd09f2.js";function J({data:l,index:a,courseUpdate:c}){const[t,p]=o.useState(l[0]),[h,w]=o.useState(l[1]),[r,b]=o.useState(l[2]);return o.useEffect(()=>{c(a,[t,h,r])},[t,h,r,c,a]),u("div",{className:"course",children:[e("input",{type:"text",onBlur:n=>p(n.currentTarget.value.trim().toUpperCase()),defaultValue:t,placeholder:"course",required:!0}),e("input",{type:"number",onBlur:n=>{const s=n.currentTarget.value.trim();w(s===""?0:parseInt(s))},defaultValue:h===0?"":h,placeholder:"unit",pattern:"[1-9]{1,2}",title:"Only one or two digit(s) are allowed",required:!0}),e("input",{type:"number",onBlur:n=>{const s=n.currentTarget.value.trim();b(s===""?0:parseInt(s))},defaultValue:r===0?"":r,placeholder:"pass",pattern:"[0-9]{2}",title:"Only two digits are allowed",required:!0})]})}let x;function j(){if(document.body.classList.contains("no-overflow")){document.body.classList.remove("no-overflow"),document.body.style.top="",window.scroll(0,x||0);return}x=window.scrollY,document.body.classList.add("no-overflow"),document.body.style.top="-"+x+"px"}function M(l,a){const c=[];for(let t=0;t<a.length;t+=l)c.push(a.slice(t,t+l));return c}function z(l,a,c){if(l==="-")return["-",0];const t=parseInt(l);return t<40||t<c?[t+"F",0*a]:t<=44?[t+"E",1*a]:t<=49?[t+"D",2*a]:t<=59?[t+"C",3*a]:t<=69?[t+"B",4*a]:[t+"A",5*a]}function _(l,a){const c=a.map((n,s)=>l[s]!=="-"?n[1]:0),t=a.map((n,s)=>l[s]!=="-"?n[2]:0),p=[],h=l.map((n,s)=>z(n,c[s],t[s])).reduce((n,s)=>(p.push(s[0]),n+=s[1],n),0),w=c.reduce((n,s)=>(n+=s,n),0),r=c.filter((n,s)=>n!==0&&parseInt(l[s])<t[s]).reduce((n,s)=>(n+=s,n),0),b=Number(h/w).toFixed(2);return{gradedScores:p,calcScores:[w,w-r,r,h,b].map(n=>n.toString())}}function K(l,a,c){var t;try{if(!l)return;const p=document.createRange();p.selectNodeContents(l);const h=window.getSelection();h==null||h.removeAllRanges(),h==null||h.addRange(p),document.execCommand("copy")&&a&&a(),(t=window.getSelection())==null||t.removeAllRanges()}catch(p){console.error(p),c&&c(p)}}var k=(l=>(l[l.alert=0]="alert",l[l.confirm=1]="confirm",l[l.prompt=2]="prompt",l))(k||{});function I({info:l,type:a,callbackOk:c,callbackCancel:t}){const[p,h]=o.useState(""),w=o.useRef(null),r=o.useRef(null),b=o.useRef(null),[n,s]=o.useState(void 0),y=f=>{f.preventDefault(),c(p)},v=o.useCallback(f=>{t&&(f.key==="Escape"||f.currentTarget===w.current)&&t()},[t]);return o.useEffect(()=>{var f;return j(),s((f=b.current)==null?void 0:f.clientHeight),document.addEventListener("keydown",v),()=>{j(),s(void 0),document.removeEventListener("keydown",v)}},[v]),e("div",{role:"dialog",className:"modal dark dialog",children:e("div",{className:"modal-content",ref:b,style:n&&n>130?{"--c-height":n+"px"}:void 0,children:e("div",{className:"modal-body p-10",children:u("form",{onSubmit:y,children:[u("div",{className:"p-tb-10 p-lr-10",children:[e("div",{children:l}),a===2&&e("input",{type:"number",className:"m-t-10 p-5",title:"Only numeral(s) are allowed",placeholder:"Enter number of courses",onInput:f=>h(f.currentTarget.value.trim()),autoFocus:!0,required:!0})]}),u("div",{className:"flex align-items-center justify-content-end flex-wrap m-tb-10 p-lr-10",children:[a!==0&&e("button",{className:"m-r-10",type:"button",ref:w,onClick:f=>v(f),children:"Cancel"}),e("button",{type:"submit",ref:r,autoFocus:a!==2,children:"Ok"})]})]})})})})}function W({clearBodyStyles:l}){const[a,c]=o.useState(null),[t,p]=o.useState(!1),[h,w]=o.useState(!1),[r,b]=o.useState(null),[n,s]=o.useState(!0),y=o.useRef(null),v=o.useRef(null),[f,A]=o.useState(null),[O,T]=o.useState(!1),L=()=>{let i=window.localStorage.getItem("courses");return i?JSON.parse(i):null};o.useEffect(()=>{l(),b(L())},[]);const G=o.useCallback(i=>{if(p(!1),!/^\d+$/.test(i))return setTimeout(()=>c("Please enter a valid numeral."),100);const g=[];for(let S=0;S<parseInt(i);S++)g.push(["",0,40]);const C=(r||[]).concat(g);window.localStorage.setItem("courses",JSON.stringify(C)),b(C)},[r]),V=o.useCallback(()=>{w(!1),window.localStorage.removeItem("courses"),b(null)},[]),q=o.useCallback((i,g)=>{const C=r||L()||[],S=C.findIndex((E,N)=>N===i);S!==-1&&(C[S]=g,window.localStorage.setItem("courses",JSON.stringify(C)),b(C))},[r]),H=o.useCallback(i=>{var B,D;if(i.preventDefault(),A(null),!r||r.length<=0)return c("Oops, please add course(s) to continue.");let C=(((B=y.current)==null?void 0:B.value.trim())||"").split(/(\t|\n)/).filter(d=>d!=="	"&&d!==`
`).filter(d=>d.trim()!=="").reduce((d,m)=>(m=m.trim(),/^(\d{1,3}[A-F]+)$/i.test(m)&&(m=m.replace(/[A-F]/gi,"")),/^\d{1,3}$/.test(m)?d.push(m):m==="-"?d.push("-"):/^(NIL|AB)$/i.test(m)?d.push("0"):d.push(m),d),[]);const S=3,E=5;C.splice(0,S+r.length+E),C.splice(0,r.length);const N=[],R=M(S+r.length,C).map(d=>(N.push(d.splice(0,S)),d));if(R.length<=0||R.some(d=>d.length!==r.length))return c("Oops, invalid result data format.");const F=[],U=[];R.forEach(d=>{const{gradedScores:m,calcScores:$}=_(d,r);F.push(m),U.push($)});const Y=N.map((d,m)=>d.concat(F[m],U[m]));A(Y),(D=v.current)==null||D.scrollIntoView({block:"start"})},[r]);return u(P,{children:[e("header",{children:e("div",{className:"doc-width p-tb-10 p-lr-20 flex justify-content-between align-items-center",children:e("h1",{children:"GPCALC"})})}),e("main",{className:"p-tb-20 main-section",children:u("div",{className:"doc-width p-lr-20",children:[u("div",{className:"m-t-10 p-10 --warning",children:[u("p",{children:[e("strong",{style:{fontSize:"16px"},children:"Note: "}),e("span",{children:"For accuracy and performant calculation, use the following format;"})]}),u("ul",{className:"m-t-10",style:{paddingLeft:"20px"},children:[e("li",{children:"Do not leave any column empty"}),e("li",{children:"Use hyphen (-) in place of score for a course the student does/did not offer"}),e("li",{children:"You can also use NIL in place of 0 (zero)"}),e("li",{children:"Use AB (ie. absent) or 0 (zero) for an absentee"})]})]}),u("div",{className:"p-tb-10 flex justify-content-end m-t-20",children:[e("button",{className:"p-10 m-r-10",onClick:()=>w(!0),disabled:!(r&&r.length>0),children:"Clear Courses"}),e("button",{className:"p-10",onClick:()=>p(!0),children:"Add Courses"})]}),u("form",{onSubmit:H,children:[u("div",{className:"p-tb-10",children:[e("h3",{children:"Courses"}),e("div",{className:"flex flex-wrap",children:r==null?void 0:r.map((i,g)=>e(J,{data:i,index:g,courseUpdate:q},g))})]}),e("div",{className:"selector m-t-20",children:u("div",{className:"selector-elems",children:[e("label",{htmlFor:"scores",children:e("h3",{children:"Scores"})}),e("textarea",{className:"p-10 m-t-10",cols:30,rows:10,id:"scores",placeholder:"Paste result table here",ref:y,required:!0}),e("div",{className:"m-t-10",children:u("label",{children:[e("input",{type:"checkbox",className:"m-r-10",onChange:()=>s(!0),checked:n,required:!0}),e("span",{children:"Result type is composite."})]})}),e("div",{className:"flex flex-wrap align-items-center m-t-20 --flex",children:e("button",{type:"submit",className:"p-10 m-r-10",children:"Calculate"})})]})})]}),e("div",{className:"flex justify-content-center",children:e("div",{className:"p-10 text-center --result-container",ref:v,children:f?u(P,{children:[u("div",{className:"flex justify-content-end m-b-10",children:[e("button",{className:"p-5 p-lr-10",style:{marginRight:"10px"},onClick:()=>{var i;return K((i=v.current)==null?void 0:i.children[1],()=>{T(!0),setTimeout(()=>{T(!1)},3*1e3)},()=>c("Copy comman failed, please try using native method."))},disabled:O,children:O?"Copied":"Copy"}),e("button",{className:"p-5 p-lr-10",onClick:()=>A(null),children:"Clear"})]}),u("table",{children:[u("thead",{children:[u("tr",{children:[e("th",{rowSpan:2,children:"S/N"}),e("th",{rowSpan:2,children:"SCHOLAR’S NAME"}),e("th",{rowSpan:2,children:"MATRIC NO"}),r==null?void 0:r.map((i,g)=>e("th",{children:i[0]},g)),e("th",{rowSpan:2,children:"TOTAL UNITS"}),e("th",{rowSpan:2,children:"UNITS PASSED"}),e("th",{rowSpan:2,children:"CARRY OVER UNITS"}),e("th",{rowSpan:2,children:"GP"}),e("th",{rowSpan:2,children:"GPA"})]}),e("tr",{children:r==null?void 0:r.map((i,g)=>e("th",{children:i[1]},g))})]}),e("tbody",{children:f.map((i,g)=>e("tr",{children:i.map((C,S)=>e("td",{children:C},S))},g))})]})]}):"Calculated result will appear here..."})})]})}),e("footer",{children:u("div",{className:"text-center doc-width p-lr-10",children:["©"," "+new Date().getFullYear()+" ",e("a",{href:"https://24cipher.com?ref=gpcalc",target:"_blank",rel:"noreferrer",children:"24Cipher Labs"})," Software License & Usage."]})}),t&&e(I,{info:"How many courses do you want to add?",type:k.prompt,callbackOk:G,callbackCancel:()=>p(!1)}),a&&e(I,{info:a,type:k.alert,callbackOk:()=>c(null)}),h&&e(I,{info:"Are you sure you want to clear courses?",type:k.confirm,callbackOk:V,callbackCancel:()=>w(!1)})]})}export{W as default};
