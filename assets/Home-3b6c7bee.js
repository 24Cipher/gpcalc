import{r as n,j as p,a as e,F}from"./index-790702fc.js";function z({data:s,index:a,courseUpdate:i}){const[u,l]=n.useState(s[0]),[h,C]=n.useState(s[1]),[b,y]=n.useState(s[2]);return n.useEffect(()=>{i(a,[u,h,b])},[u,h,b,i,a]),p("div",{className:"course",children:[e("input",{type:"text",onBlur:t=>l(t.currentTarget.value.trim().toUpperCase()),defaultValue:u,placeholder:"course",required:!0}),e("input",{type:"number",onBlur:t=>{const r=t.currentTarget.value.trim();C(r===""?0:parseInt(r))},defaultValue:h===0?"":h,placeholder:"unit",pattern:"[1-9]{1,2}",title:"Only one or two digit(s) are allowed",required:!0}),e("input",{type:"number",onBlur:t=>{const r=t.currentTarget.value.trim();y(r===""?0:parseInt(r))},defaultValue:b===0?"":b,placeholder:"pass",pattern:"[0-9]{2}",title:"Only two digits are allowed",required:!0})]})}let E;function H(){if(document.body.classList.contains("no-overflow")){document.body.classList.remove("no-overflow"),document.body.style.top="",window.scroll(0,E||0);return}E=window.scrollY,document.body.classList.add("no-overflow"),document.body.style.top="-"+E+"px"}function K(s,a){const i=[];for(let u=0;u<a.length;u+=s)i.push(a.slice(u,u+s));return i}function Q(s,a,i){let u=s.match(/(-|NIL|AB)/i);if(u)return[u[0],0];const l=parseInt(s);return l<40||l<i?[l+"F",0*a]:l<=44?[l+"E",1*a]:l<=49?[l+"D",2*a]:l<=59?[l+"C",3*a]:l<=69?[l+"B",4*a]:[l+"A",5*a]}function W(s,a){const i=a.map((t,r)=>s[r]!=="-"?t[1]:0),u=a.map((t,r)=>s[r]!=="-"?t[2]:0),l=[],h=s.map((t,r)=>Q(t,i[r],u[r])).reduce((t,r)=>(l.push(r[0]),t+=r[1],t),0),C=i.reduce((t,r)=>(t+=r,t),0),b=i.filter((t,r)=>t!==0&&(/(NIL|AB)/i.test(s[r])||parseInt(s[r])<u[r])).reduce((t,r)=>(t+=r,t),0),y=Number(h/C).toFixed(2);return{gradedScores:l,calcScores:[C,C-b,b,h,y].map(t=>t.toString())}}function X(s,a,i){var u;try{if(!s)return;const l=document.createRange();l.selectNodeContents(s);const h=window.getSelection();h==null||h.removeAllRanges(),h==null||h.addRange(l),document.execCommand("copy")&&a&&a(),(u=window.getSelection())==null||u.removeAllRanges()}catch(l){console.error(l),i&&i(l)}}var T=(s=>(s.alert="alert",s.confirm="confirm",s.prompt="prompt",s))(T||{});function O({info:s,type:a,callbackOk:i,callbackCancel:u}){const[l,h]=n.useState(""),C=n.useRef(null),b=n.useRef(null),y=n.useRef(null),t=n.useRef(null),[r,N]=n.useState(void 0),x=n.useCallback(m=>{var R;if(!(m.key!=="Enter"&&m.currentTarget!==C.current)){if(a==="prompt"&&l==="")return(R=y.current)==null?void 0:R.focus();i(l)}},[i,l,a]),S=n.useCallback(m=>{u&&(m.key==="Escape"||m.currentTarget===b.current)&&u()},[u]);return n.useEffect(()=>{var m;return H(),N((m=t.current)==null?void 0:m.clientHeight),document.addEventListener("keydown",S),document.addEventListener("keydown",x),()=>{H(),N(void 0),document.removeEventListener("keydown",S),document.removeEventListener("keydown",x)}},[S,x]),e("div",{role:"dialog",className:"modal dark dialog",children:e("div",{className:"modal-content",ref:t,style:r&&r>130?{"--c-height":r+"px"}:void 0,children:p("div",{className:"modal-body p-10",children:[e("div",{className:"p-tb-10 p-lr-10",children:a==="prompt"?p(F,{children:[e("label",{htmlFor:"promptInput",children:s}),e("input",{type:"number",id:"promptInput",className:"m-t-10",title:"Only numeral(s) are allowed",placeholder:"Enter number of courses",style:{padding:"8px"},ref:y,onInput:m=>h(m.currentTarget.value.trim()),autoFocus:!0})]}):e("p",{children:s})}),p("div",{className:"flex align-items-center justify-content-end flex-wrap m-tb-10 p-lr-10",children:[a!=="alert"&&e("button",{className:"m-r-10",type:"button",ref:b,onClick:S,children:"Cancel"}),e("button",{type:"button",ref:C,onClick:x,autoFocus:a!=="prompt",children:"Ok"})]})]})})})}function ee({clearBodyStyles:s}){const[a,i]=n.useState(null),[u,l]=n.useState(!1),[h,C]=n.useState(!1),[b,y]=n.useState(!1),[t,r]=n.useState(null),[N,x]=n.useState(""),S=n.useRef(null),[m,R]=n.useState(!1),L=n.useRef(3),_=n.useRef(5),[U,B]=n.useState(null),D=n.useRef(null),[P,I]=n.useState(null),[j,G]=n.useState(!1);n.useEffect(()=>{s(),r(V())},[s]),n.useEffect(()=>{(!t||t.length<=0)&&(R(!1),I(null))},[t]);const V=()=>{let o=window.localStorage.getItem("courses");return o?JSON.parse(o):null},q=n.useCallback(o=>{if(l(!1),!/^\d+$/.test(o))return setTimeout(()=>i("Please enter a valid numeral."),50);const c=[];for(let w=0;w<parseInt(o);w++)c.push(["",0,40]);const f=(t||[]).concat(c);r(f),window.localStorage.setItem("courses",JSON.stringify(f))},[t]),J=n.useCallback(()=>{C(!1),window.localStorage.removeItem("courses"),r(null)},[]),Y=n.useCallback((o,c)=>{const f=t||V()||[],w=f.findIndex((k,g)=>g===o);w!==-1&&(f[w]=c,window.localStorage.setItem("courses",JSON.stringify(f)),r(f))},[t]),M=n.useCallback(()=>{try{if(y(!1),!t||t.length<=0)throw new Error("Oops, please add course(s) to continue.");const o=[],c=K(L.current+t.length,U||[]).map(g=>(o.push(g.splice(0,L.current)),g));if(c.length<=0||c.some(g=>g.length!==t.length))throw new Error("Oops, invalid result sheet format.");const f=[],w=[];c.forEach(g=>{const{gradedScores:d,calcScores:v}=W(g,t);f.push(d),w.push(v)});const k=o.map((g,d)=>g.concat(f[d],w[d]));I(k),setTimeout(()=>{var g;return(g=D.current)==null?void 0:g.scrollIntoView({block:"start"})},50)}catch(o){setTimeout(()=>i(o.message),50)}},[U,t]),$=n.useCallback(o=>{try{if(o.preventDefault(),I(null),B(null),!/\t/.test(N))throw new Error("Ooops, it appears that result data is not a spreadsheet.");let c=N.split(/(\t|\n)/).map(d=>d.replace(/(\\t|\\n)/g," ")).map(d=>d.trim()).filter(d=>d!=="").reduce((d,v)=>(/^(\d{1,3}[A-F]+)$/i.test(v)&&(v=v.replace(/[A-F]/gi,"")),d.push(v),d),[]);const f=c.findIndex(d=>d.toLowerCase()==="gpa");if(f===-1)throw new Error("Oops, invalid result data format.");const w=c.splice(0,f+1),k=w.slice(L.current,w.length-_.current),g=c.splice(0,k.length).map(d=>parseInt(d)).map(d=>isNaN(d)?0:d);if(B(c),!m){r(null);const d=[];for(let A=0;A<k.length;A++)d.push([k[A],g[A],40]);const v=[].concat(d);setTimeout(()=>{r(v),window.localStorage.setItem("courses",JSON.stringify(v))},50)}y(!0)}catch(c){i(c.message)}},[N,m]);return p(F,{children:[e("header",{children:e("nav",{className:"doc-width p-tb-10 p-lr-20 flex justify-content-between align-items-center",children:e("h1",{children:"GPCALC"})})}),e("main",{className:"p-tb-20 main-section",children:p("div",{className:"doc-width p-lr-20",children:[p("div",{className:"m-t-10 p-10 --warning",children:[p("p",{children:[e("strong",{style:{fontSize:"16px"},children:"Note: "}),e("span",{children:"For accuracy and performant calculation, use the following format;"})]}),p("ul",{className:"m-t-10",style:{paddingLeft:"20px"},children:[e("li",{children:"Do not leave any score column empty"}),e("li",{children:"Use hyphen (-) in place of score for a course the student does/did not offer"}),e("li",{children:"You can also use NIL in place of 0 (zero)"}),e("li",{children:"Use AB (ie. absent) or 0 (zero) for an absentee"}),p("li",{children:[e("a",{href:"composite-result-template.xlsx",target:"_blank",rel:"noreferrer",children:"Click here"}),e("span",{children:" to download a sample of a result sheet."})]})]})]}),p("div",{className:"p-tb-10 flex justify-content-end m-t-20",children:[e("button",{className:"p-10 m-r-10",onClick:()=>C(!0),disabled:!(t&&t.length>0),children:"Clear Courses"}),e("button",{className:"p-10",onClick:()=>l(!0),children:"Add Courses"})]}),p("form",{onSubmit:$,children:[p("div",{className:"p-tb-10",children:[e("h3",{children:"Courses"}),e("div",{className:"flex flex-wrap",children:t?t==null?void 0:t.map((o,c)=>e(z,{data:o,index:c,courseUpdate:Y},c)):e("p",{style:{marginTop:"10px",textAlign:"left"},children:'Course(s) are automatically added, optionally you can use the "Add Courses" button to manually add course(s).'})})]}),e("div",{className:"selector m-t-20",children:p("div",{className:"selector-elems",children:[e("label",{htmlFor:"resultTable",children:e("h3",{children:"Result sheet"})}),p("div",{className:"m-t-10",style:{position:"relative"},children:[N!==""&&e("button",{type:"button",style:{backgroundColor:"rgba(68, 68, 68, 0.4)",color:"#fff",position:"absolute",top:"10px",right:"10px",padding:"5px 10px",border:"none"},onClick:()=>{x(""),S.current&&(S.current.value="")},children:"Clear"}),e("textarea",{className:"p-10",cols:30,rows:10,id:"resultTable",placeholder:"Paste result spreadsheet here",onInput:o=>x(o.currentTarget.value.trim()),ref:S,required:!0})]}),t&&t.length>0&&e("div",{className:"m-t-10",children:p("label",{children:[e("input",{type:"checkbox",className:"m-r-10",onChange:()=>R(!m),checked:m}),e("span",{style:{userSelect:"none"},children:"Use existing added courses"})]})}),e("div",{className:"flex flex-wrap align-items-center --flex",style:{marginTop:"30px"},children:e("button",{type:"submit",className:"p-10 m-r-10",children:"Calculate"})})]})})]}),e("div",{className:"text-center m-t-20 p-tb-20",ref:D,children:P?p(F,{children:[p("div",{className:"flex justify-content-end flex-wrap",children:[e("button",{className:"p-5 p-lr-10",style:{marginRight:"10px"},onClick:()=>{var o;return X((o=D.current)==null?void 0:o.children[1],()=>{G(!0),setTimeout(()=>{G(!1)},3*1e3)},()=>i("Copy comman failed, please try using native method."))},disabled:j,children:j?"Copied":"Copy"}),e("button",{className:"p-5 p-lr-10",onClick:()=>I(null),children:"Clear"})]}),e("div",{className:"--result-table-wrap p-tb-10",children:p("table",{children:[p("thead",{children:[p("tr",{children:[e("th",{rowSpan:2,children:"S/N"}),e("th",{rowSpan:2,children:"SCHOLAR’S NAME"}),e("th",{rowSpan:2,children:"MATRIC NO"}),t==null?void 0:t.map((o,c)=>e("th",{children:o[0]},c)),e("th",{rowSpan:2,children:"TOTAL UNITS"}),e("th",{rowSpan:2,children:"UNITS PASSED"}),e("th",{rowSpan:2,children:"CARRY OVER UNITS"}),e("th",{rowSpan:2,children:"GP"}),e("th",{rowSpan:2,children:"GPA"})]}),e("tr",{children:t==null?void 0:t.map((o,c)=>e("th",{children:o[1]},c))})]}),e("tbody",{children:P.map((o,c)=>e("tr",{children:o.map((f,w)=>e("td",{children:f},w))},c))})]})})]}):"Calculated result will appear here..."})]})}),e("footer",{children:p("div",{className:"text-center doc-width p-lr-10",children:[p("span",{children:["©"," "+new Date().getFullYear()+" "]}),e("a",{href:"https://24cipher.com?ref=gpcalc",target:"_blank",rel:"noreferrer",children:"24Cipher Labs"}),e("span",{children:" Software License & Usage."})]})}),u&&e(O,{info:"How many courses do you want to add?",type:T.prompt,callbackOk:q,callbackCancel:()=>l(!1)}),a&&e(O,{info:a,type:T.alert,callbackOk:()=>i(null)}),h&&e(O,{info:"Are you sure you want to clear courses?",type:T.confirm,callbackOk:J,callbackCancel:()=>C(!1)}),b&&e(O,{info:"Do you want to continue without reviewing added courses?",type:T.confirm,callbackOk:M,callbackCancel:()=>y(!1)})]})}export{ee as default};
