import{r,j as d,a as e,F}from"./index-49289505.js";function z({data:s,index:a,courseUpdate:i}){const[n,p]=r.useState(s[0]),[h,b]=r.useState(s[1]),[y,v]=r.useState(s[2]);return r.useEffect(()=>{i(a,[n,h,y])},[n,h,y,i,a]),d("div",{className:"course",children:[e("input",{type:"text",onBlur:t=>p(t.currentTarget.value.trim().toUpperCase()),defaultValue:n,placeholder:"course",required:!0}),e("input",{type:"number",onBlur:t=>{const l=t.currentTarget.value.trim();b(l===""?0:parseInt(l))},defaultValue:h===0?"":h,placeholder:"unit",pattern:"[1-9]{1,2}",title:"Only one or two digit(s) are allowed",required:!0}),e("input",{type:"number",onBlur:t=>{const l=t.currentTarget.value.trim();v(l===""?0:parseInt(l))},defaultValue:y===0?"":y,placeholder:"pass",pattern:"[0-9]{2}",title:"Only two digits are allowed",required:!0})]})}let E;function V(){if(document.body.classList.contains("no-overflow")){document.body.classList.remove("no-overflow"),document.body.style.top="",window.scroll(0,E||0);return}E=window.scrollY,document.body.classList.add("no-overflow"),document.body.style.top="-"+E+"px"}function K(s,a){const i=[];for(let n=0;n<a.length;n+=s)i.push(a.slice(n,n+s));return i}function Q(s,a,i){if(s==="-")return["-",0];const n=parseInt(s);return n<40||n<i?[n+"F",0*a]:n<=44?[n+"E",1*a]:n<=49?[n+"D",2*a]:n<=59?[n+"C",3*a]:n<=69?[n+"B",4*a]:[n+"A",5*a]}function W(s,a){const i=a.map((t,l)=>s[l]!=="-"?t[1]:0),n=a.map((t,l)=>s[l]!=="-"?t[2]:0),p=[],h=s.map((t,l)=>Q(t,i[l],n[l])).reduce((t,l)=>(p.push(l[0]),t+=l[1],t),0),b=i.reduce((t,l)=>(t+=l,t),0),y=i.filter((t,l)=>t!==0&&parseInt(s[l])<n[l]).reduce((t,l)=>(t+=l,t),0),v=Number(h/b).toFixed(2);return{gradedScores:p,calcScores:[b,b-y,y,h,v].map(t=>t.toString())}}function X(s,a,i){var n;try{if(!s)return;const p=document.createRange();p.selectNodeContents(s);const h=window.getSelection();h==null||h.removeAllRanges(),h==null||h.addRange(p),document.execCommand("copy")&&a&&a(),(n=window.getSelection())==null||n.removeAllRanges()}catch(p){console.error(p),i&&i(p)}}var T=(s=>(s.alert="alert",s.confirm="confirm",s.prompt="prompt",s))(T||{});function O({info:s,type:a,callbackOk:i,callbackCancel:n}){const[p,h]=r.useState(""),b=r.useRef(null),y=r.useRef(null),v=r.useRef(null),t=r.useRef(null),[l,x]=r.useState(void 0),N=r.useCallback(m=>{var R;if(!(m.key!=="Enter"&&m.currentTarget!==b.current)){if(a==="prompt"&&p==="")return(R=v.current)==null?void 0:R.focus();i(p)}},[i,p,a]),S=r.useCallback(m=>{n&&(m.key==="Escape"||m.currentTarget===y.current)&&n()},[n]);return r.useEffect(()=>{var m;return V(),x((m=t.current)==null?void 0:m.clientHeight),document.addEventListener("keydown",S),document.addEventListener("keydown",N),()=>{V(),x(void 0),document.removeEventListener("keydown",S),document.removeEventListener("keydown",N)}},[S,N]),e("div",{role:"dialog",className:"modal dark dialog",children:e("div",{className:"modal-content",ref:t,style:l&&l>130?{"--c-height":l+"px"}:void 0,children:d("div",{className:"modal-body p-10",children:[e("div",{className:"p-tb-10 p-lr-10",children:a==="prompt"?d(F,{children:[e("label",{htmlFor:"promptInput",children:s}),e("input",{type:"number",id:"promptInput",className:"m-t-10",title:"Only numeral(s) are allowed",placeholder:"Enter number of courses",style:{padding:"8px"},ref:v,onInput:m=>h(m.currentTarget.value.trim()),autoFocus:!0})]}):e("p",{children:s})}),d("div",{className:"flex align-items-center justify-content-end flex-wrap m-tb-10 p-lr-10",children:[a!=="alert"&&e("button",{className:"m-r-10",type:"button",ref:y,onClick:S,children:"Cancel"}),e("button",{type:"button",ref:b,onClick:N,autoFocus:a!=="prompt",children:"Ok"})]})]})})})}function ee({clearBodyStyles:s}){const[a,i]=r.useState(null),[n,p]=r.useState(!1),[h,b]=r.useState(!1),[y,v]=r.useState(!1),[t,l]=r.useState(null),[x,N]=r.useState(""),S=r.useRef(null),[m,R]=r.useState(!1),L=r.useRef(3),_=r.useRef(5),[U,P]=r.useState(null),D=r.useRef(null),[B,I]=r.useState(null),[j,G]=r.useState(!1);r.useEffect(()=>{s(),l(H())},[s]),r.useEffect(()=>{(!t||t.length<=0)&&(R(!1),I(null))},[t]);const H=()=>{let o=window.localStorage.getItem("courses");return o?JSON.parse(o):null},q=r.useCallback(o=>{if(p(!1),!/^\d+$/.test(o))return setTimeout(()=>i("Please enter a valid numeral."),50);const u=[];for(let w=0;w<parseInt(o);w++)u.push(["",0,40]);const f=(t||[]).concat(u);l(f),window.localStorage.setItem("courses",JSON.stringify(f))},[t]),J=r.useCallback(()=>{b(!1),window.localStorage.removeItem("courses"),l(null)},[]),Y=r.useCallback((o,u)=>{const f=t||H()||[],w=f.findIndex((k,g)=>g===o);w!==-1&&(f[w]=u,window.localStorage.setItem("courses",JSON.stringify(f)),l(f))},[t]),$=r.useCallback(()=>{try{if(v(!1),!t||t.length<=0)throw new Error("Oops, please add course(s) to continue.");const o=[],u=K(L.current+t.length,U||[]).map(g=>(o.push(g.splice(0,L.current)),g));if(u.length<=0||u.some(g=>g.length!==t.length))throw new Error("Oops, invalid result data format.");const f=[],w=[];u.forEach(g=>{const{gradedScores:c,calcScores:C}=W(g,t);f.push(c),w.push(C)});const k=o.map((g,c)=>g.concat(f[c],w[c]));I(k),setTimeout(()=>{var g;return(g=D.current)==null?void 0:g.scrollIntoView({block:"start"})},50)}catch(o){setTimeout(()=>i(o.message),50)}},[U,t]),M=r.useCallback(o=>{try{o.preventDefault(),I(null),P(null);let u=x.split(/(\t|\n)/).filter(c=>c!=="	"&&c!==`
`).filter(c=>c.trim()!=="").reduce((c,C)=>(C=C.trim(),/^(\d{1,3}[A-F]+)$/i.test(C)&&(C=C.replace(/[A-F]/gi,"")),/^\d{1,3}$/.test(C)?c.push(C):C==="-"?c.push("-"):/^(NIL|AB)$/i.test(C)?c.push("0"):c.push(C),c),[]);const f=u.findIndex(c=>c.toLowerCase()==="gpa");if(f===-1)throw new Error("Oops, invalid result data format.");const w=u.splice(0,f+1),k=w.slice(L.current,w.length-_.current),g=u.splice(0,k.length).map(c=>parseInt(c)).map(c=>isNaN(c)?0:c);if(P(u),!m){l(null);const c=[];for(let A=0;A<k.length;A++)c.push([k[A],g[A],40]);const C=[].concat(c);setTimeout(()=>{l(C),window.localStorage.setItem("courses",JSON.stringify(C))},50)}v(!0)}catch(u){i(u.message)}},[x,m]);return d(F,{children:[e("header",{children:e("div",{className:"doc-width p-tb-10 p-lr-20 flex justify-content-between align-items-center",children:e("h1",{children:"GPCALC"})})}),e("main",{className:"p-tb-20 main-section",children:d("div",{className:"doc-width p-lr-20",children:[d("div",{className:"m-t-10 p-10 --warning",children:[d("p",{children:[e("strong",{style:{fontSize:"16px"},children:"Note: "}),e("span",{children:"For accuracy and performant calculation, use the following format;"})]}),d("ul",{className:"m-t-10",style:{paddingLeft:"20px"},children:[e("li",{children:"Do not leave any column empty"}),e("li",{children:"Use hyphen (-) in place of score for a course the student does/did not offer"}),e("li",{children:"You can also use NIL in place of 0 (zero)"}),e("li",{children:"Use AB (ie. absent) or 0 (zero) for an absentee"}),d("li",{children:[e("a",{href:"result-table-sample.png",target:"_blank",rel:"noreferrer",children:"Here"}),e("span",{children:" is a sample of a result table."})]})]})]}),d("div",{className:"p-tb-10 flex justify-content-end m-t-20",children:[e("button",{className:"p-10 m-r-10",onClick:()=>b(!0),disabled:!(t&&t.length>0),children:"Clear Courses"}),e("button",{className:"p-10",onClick:()=>p(!0),children:"Add Courses"})]}),d("form",{onSubmit:M,children:[d("div",{className:"p-tb-10",children:[e("h3",{children:"Courses"}),e("div",{className:"flex flex-wrap",children:t?t==null?void 0:t.map((o,u)=>e(z,{data:o,index:u,courseUpdate:Y},u)):e("p",{style:{marginTop:"10px",textAlign:"left"},children:'Course(s) are automatically added, optionally you can use the "Add Courses" button to manually add course(s).'})})]}),e("div",{className:"selector m-t-20",children:d("div",{className:"selector-elems",children:[e("label",{htmlFor:"resultTable",children:e("h3",{children:"Result table"})}),d("div",{className:"m-t-10",style:{position:"relative"},children:[x!==""&&e("button",{type:"button",style:{backgroundColor:"rgba(68, 68, 68, 0.4)",color:"#fff",position:"absolute",top:"10px",right:"10px",padding:"5px 10px",border:"none"},onClick:()=>{N(""),S.current&&(S.current.value="")},children:"Clear"}),e("textarea",{className:"p-10",cols:30,rows:10,id:"resultTable",placeholder:"Paste result table here",onInput:o=>N(o.currentTarget.value.trim()),ref:S,required:!0})]}),t&&t.length>0&&e("div",{className:"m-t-10",children:d("label",{children:[e("input",{type:"checkbox",className:"m-r-10",onChange:()=>R(!m),checked:m}),e("span",{style:{userSelect:"none"},children:"Use existing added courses"})]})}),e("div",{className:"flex flex-wrap align-items-center --flex",style:{marginTop:"30px"},children:e("button",{type:"submit",className:"p-10 m-r-10",children:"Calculate"})})]})})]}),e("div",{className:"text-center m-t-20 p-tb-20",ref:D,children:B?d(F,{children:[d("div",{className:"flex justify-content-end flex-wrap",children:[e("button",{className:"p-5 p-lr-10",style:{marginRight:"10px"},onClick:()=>{var o;return X((o=D.current)==null?void 0:o.children[1],()=>{G(!0),setTimeout(()=>{G(!1)},3*1e3)},()=>i("Copy comman failed, please try using native method."))},disabled:j,children:j?"Copied":"Copy"}),e("button",{className:"p-5 p-lr-10",onClick:()=>I(null),children:"Clear"})]}),e("div",{className:"--result-table-wrap p-tb-10",children:d("table",{children:[d("thead",{children:[d("tr",{children:[e("th",{rowSpan:2,children:"S/N"}),e("th",{rowSpan:2,children:"SCHOLAR’S NAME"}),e("th",{rowSpan:2,children:"MATRIC NO"}),t==null?void 0:t.map((o,u)=>e("th",{children:o[0]},u)),e("th",{rowSpan:2,children:"TOTAL UNITS"}),e("th",{rowSpan:2,children:"UNITS PASSED"}),e("th",{rowSpan:2,children:"CARRY OVER UNITS"}),e("th",{rowSpan:2,children:"GP"}),e("th",{rowSpan:2,children:"GPA"})]}),e("tr",{children:t==null?void 0:t.map((o,u)=>e("th",{children:o[1]},u))})]}),e("tbody",{children:B.map((o,u)=>e("tr",{children:o.map((f,w)=>e("td",{children:f},w))},u))})]})})]}):"Calculated result will appear here..."})]})}),e("footer",{children:d("div",{className:"text-center doc-width p-lr-10",children:[d("span",{children:["©"," "+new Date().getFullYear()+" "]}),e("a",{href:"https://24cipher.com?ref=gpcalc",target:"_blank",rel:"noreferrer",children:"24Cipher Labs"}),e("span",{children:" Software License & Usage."})]})}),n&&e(O,{info:"How many courses do you want to add?",type:T.prompt,callbackOk:q,callbackCancel:()=>p(!1)}),a&&e(O,{info:a,type:T.alert,callbackOk:()=>i(null)}),h&&e(O,{info:"Are you sure you want to clear courses?",type:T.confirm,callbackOk:J,callbackCancel:()=>b(!1)}),y&&e(O,{info:"Do you want to continue without reviewing added courses?",type:T.confirm,callbackOk:$,callbackCancel:()=>v(!1)})]})}export{ee as default};
